<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Drawware IDE</title>
</head>
<body>
    <h1>Drawware IDE</h1>
    
    <!-- Go button -->
    <button id="goButton" style="width:100px;background:#F7DFDA;border-radius:6px">Go</button>

    <!-- Editable textarea -->
    <textarea id="filename" rows="1" cols="80" placeholder="Type .drawio filename here..."></textarea>
    
    <h3>Input:</h3>
    <textarea id="myTextarea" rows="3" cols="80" placeholder="Type input text here..."></textarea>
    
    <!-- Readonly textarea to display server responses -->
    <h3>Output:</h3>
    <textarea id="output" rows="3" cols="80" readonly></textarea>

    <h3>Errors:</h3>
    <textarea id="output" rows="1" cols="30" readonly></textarea>

    <h3>Probes (A,B,C):</h3>
    <textarea id="output" rows="1" cols="30" readonly></textarea>

    <textarea id="output" rows="1" cols="30" readonly></textarea>

    <textarea id="output" rows="1" cols="30" readonly></textarea>

    <script>
        // Open a WebSocket connection to the server
        const socket = new WebSocket('ws://localhost:6789');

        // Get the textarea, button, and readonly textarea elements
        const textarea = document.getElementById('myTextarea');
        const goButton = document.getElementById('goButton');
        const output = document.getElementById('output');

        // Send the content of the textarea on input change
        textarea.addEventListener('input', () => {
            if (socket.readyState === WebSocket.OPEN) {
                const message = JSON.stringify({
                    name: textarea.id,
                    content: textarea.value
                });
                socket.send(message);
            }
        });

        // Send an empty string with the button's ID when the button is clicked
        goButton.addEventListener('click', () => {
            if (socket.readyState === WebSocket.OPEN) {
                const message = JSON.stringify({
                    name: goButton.id,
                    content: ""
                });
                socket.send(message);
            }
        });

        // Handle incoming messages from the server
        socket.addEventListener('message', (event) => {
            const data = JSON.parse(event.data);

            // Check if the message is for the readonly textarea
            if (data.name === output.id) {
                output.value = data.content;  // Update the readonly textarea
            }
        });

      // Handle connection open
      socket.onopen = () => {
          console.log("Connected to WebSocket server.");
      };
      // Handle connection closure
      socket.onclose = () => {
          console.log("Disconnected from WebSocket server.");
      };
      
        // Handle connection errors
        socket.addEventListener('error', (error) => {
            console.error('WebSocket error:', error);
        });
    </script>
</body>
</html>
